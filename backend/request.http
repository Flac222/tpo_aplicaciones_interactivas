@baseUrl = http://localhost:3000
@userId = 9aba693f-2414-402a-9ecd-d3f8479a1b4c
@equipoId = 9068b2a3-95fd-4e43-a809-8820ba07d2f8
@tareaId = dd496250-8ade-41c4-890b-2cbf11efc12f
@user2Id = 76a71a0d-6fa4-421f-9ffd-98bcb6634430
@commentId = f23c2b45-8c35-436d-96cd-0f9a6e15afc6
@token =

###
### Swagger UI
GET {{baseUrl}}/docs


### Estado del sistema
GET {{baseUrl}}/api/status


### ---------- Usuarios ----------

### Registrar usuario
POST {{baseUrl}}/api/users/register
Content-Type: application/json

{
  "nombre": "Ezequiel2",
  "email": "eze4@example.com.ar",
  "password": "123456"
}

###
### Login (IMPORTANTE: Este paso es el primero)
# @name loginRequest
POST {{baseUrl}}/api/users/login
Content-Type: application/json

{
  "email": "eze4@example.com.ar",
  "password": "123456"
}

### <--- ¡¡ESTA LÍNEA ES LA SOLUCIÓN!!

# Captura el token de la respuesta de login
# Asume que la respuesta es un JSON como: { "token": "tu_jwt_aqui" }
@token = {{loginRequest.response.body.token}}

# (Opcional) Puedes imprimir el token para verificarlo
# @tokenPreview = {{token}}
###
### Actualizar usuario (Requiere Auth)
PUT {{baseUrl}}/api/users/{{userId}}
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "nombre": "EzequielPepe",
  "email": "eze4@example.com.ar",
  "password": "123456"
}

###
### Borrar usuario (Requiere Auth)
DELETE {{baseUrl}}/api/users/{{userId}}
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "id": "{{userId}}"
}


### ---------- Equipos ----------

### Salir del equipo (Requiere Auth)
POST {{baseUrl}}/api/equipos/{{equipoId}}/salir
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "userId": "{{user2Id}}"
}

###
### Obtener Equipos (Requiere Auth)
GET {{baseUrl}}/api/equipos/equipos/{{userId}}
Content-Type: application/json
Authorization: Bearer {{token}}

# Nota: Los GET con body son inusuales. 
# Si el 'userId' ya está en la URL, este body es redundante.
{
  "userId": "{{userId}}"
}

###
### Crear equipo (Requiere Auth)
POST {{baseUrl}}/api/equipos/{{userId}}
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "nombre": "Equipo Backend",
  "propietarioId": "{{userId}}" 

}

###
### Invitar miembro al equipo (Requiere Auth)
POST {{baseUrl}}/api/equipos/{{equipoId}}/invitar
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "usuarioId": "{{user2Id}}",
  "propietarioId": "{{userId}}"
}

###
### Borrar equipo (Requiere Auth)
DELETE {{baseUrl}}/api/equipos/{{equipoId}}
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "userId": "{{userId}}"
}


### ---------- Tareas ----------

### Listar tareas por filtro (Requiere Auth)
GET {{baseUrl}}/api/tareas/{{equipoId}}
Content-Type: application/json
Authorization: Bearer {{token}}

# Nota: Los GET con body son inusuales. 
# Es mejor pasar filtros como query params, ej:
# GET {{baseUrl}}/api/tareas/{{equipoId}}?prioridad=Alta&estado=Pendiente
{
  "equipoId": "{{equipoId}}",
  "prioridad": "Alta",
  "estado": "Pendiente"
}

###
### Crear tarea (Requiere Auth)
POST {{baseUrl}}/api/tareas
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "titulo": "Implementar login",
  "descripcion": "Crear endpoint de login con JWT",
  "equipoId": "{{equipoId}}",
  "prioridad": "Alta",
  "estado": "Pendiente"
}

###
### Cambiar estado de tarea (Requiere Auth)
PUT {{baseUrl}}/api/tareas/{{tareaId}}/estado
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "nuevoEstado": "En curso",
  "usuarioId": "{{userId}}"
}

###
### Eliminar tarea (Requiere Auth)
DELETE {{baseUrl}}/api/tareas/{{tareaId}}/{{userId}}
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "tareaId": "{{tareaId}}",
  "usuarioId": "{{userId}}"
}

### ---------- Comentarios ----------

### Listar comentarios de una tarea (Requiere Auth)
GET {{baseUrl}}/api/comentarios/tareas/{{tareaId}}/comentarios
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "tareaId": "{{tareaId}}"
}

###
### Crear comentario en una tarea (Requiere Auth)
POST {{baseUrl}}/api/comentarios/tareas/{{tareaId}}/comentarios
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "contenido": "Este es un comentario de prueba.",
  "creadorId": "{{userId}}"
}

###
### Editar comentario (Requiere Auth)
PUT {{baseUrl}}/api/comentarios/comentarios/{{commentId}}
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "contenido": "Comentario editado."
}

###
### Eliminar comentario (Requiere Auth)
DELETE {{baseUrl}}/api/comentarios/comentarios/{{commentId}}
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "id": "{{commentId}}"
}